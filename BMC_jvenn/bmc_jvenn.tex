%% BioMed_Central_Tex_Template_v1.06
%%                                      %
%  bmc_article.tex            ver: 1.06 %
%                                       %

%%IMPORTANT: do not delete the first line of this template
%%It must be present to enable the BMC Submission system to
%%recognise this template!!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                     %%
%%  LaTeX template for BioMed Central  %%
%%     journal article submissions     %%
%%                                     %%
%%          <8 June 2012>              %%
%%                                     %%
%%                                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                 %%
%% For instructions on how to fill out this Tex template           %%
%% document please refer to Readme.html and the instructions for   %%
%% authors page on the biomed central website                      %%
%% http://www.biomedcentral.com/info/authors/                      %%
%%                                                                 %%
%% Please do not use \input{...} to include other tex files.       %%
%% Submit your LaTeX manuscript as one .tex document.              %%
%%                                                                 %%
%% All additional figures and files should be attached             %%
%% separately and not embedded in the \TeX\ document itself.       %%
%%                                                                 %%
%% BioMed Central currently use the MikTex distribution of         %%
%% TeX for Windows) of TeX and LaTeX.  This is available from      %%
%% http://www.miktex.org                                           %%
%%                                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% additional documentclass options:
%  [doublespacing]
%  [linenumbers]   - put the line numbers on margins

%%% loading packages, author definitions

%\documentclass[twocolumn]{bmcart}% uncomment this for twocolumn layout and comment line below
\documentclass{bmcart}

%%% Load packages
\usepackage{listings}
\usepackage{color}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\lstset{
  language=Java,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\scriptsize \ttfamily},
  numbers=none,
  stringstyle=\color{gray},
  breaklines=true,
  breakatwhitespace=true
}
%\usepackage{amsthm,amsmath}
%\RequirePackage{natbib}
%\RequirePackage{hyperref}
\usepackage[utf8]{inputenc} %unicode support
%\usepackage[applemac]{inputenc} %applemac support if unicode package fails
%\usepackage[latin1]{inputenc} %UNIX support if unicode package fails


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                             %%
%%  If you wish to display your graphics for   %%
%%  your own use using includegraphic or       %%
%%  includegraphics, then comment out the      %%
%%  following two lines of code.               %%
%%  NB: These line *must* be included when     %%
%%  submitting to BMC.                         %%
%%  All figure files must be submitted as      %%
%%  separate graphics through the BMC          %%
%%  submission process, not included in the    %%
%%  submitted article.                         %%
%%                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\def\includegraphic{}
\def\includegraphics{}



%%% Put your definitions there:
\startlocaldefs
\endlocaldefs


%%% Begin ...
\begin{document}

%%% Start of article front matter
\begin{frontmatter}

\begin{fmbox}
\dochead{Software}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the title of your article here     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{jvenn: an interactive Venn diagram viewer.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors here                   %%
%%                                          %%
%% Specify information, if available,       %%
%% in the form:                             %%
%%   <key>={<id1>,<id2>}                    %%
%%   <key>=                                 %%
%% Comment or delete the keys which are     %%
%% not used. Repeat \author command as much %%
%% as required.                             %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author[
   addressref={aff2},                   % id's of addresses, e.g. {aff1,aff2}
   noteref={n1},                        % id's of article notes, if any
   email={Philippe.Bardou@toulouse.inra.fr}   % email address
]{\inits{PB}\fnm{Philippe} \snm{Bardou}}
\author[
   addressref={aff1},
   corref={aff1},                       % id of corresponding address, if any
   noteref={n1},                        % id's of article notes, if any
   email={Jerome.Mariette@toulouse.inra.fr}
]{\inits{JM}\fnm{J\'{e}r\^{o}me} \snm{Mariette}}
\author[
   addressref={aff1},
   email={Frederic.Escudie@toulouse.inra.fr}
]{\inits{FE}\fnm{Frederic} \snm{Escudie}}
\author[
   addressref={aff1},
   email={Christophe.Djemiel@toulouse.inra.fr}
]{\inits{CD}\fnm{Christophe} \snm{Djemiel}}
\author[
   addressref={aff1,aff2},
   email={Christophe.Klopp@toulouse.inra.fr}
]{\inits{CK}\fnm{Christophe} \snm{Klopp}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter the authors' addresses here        %%
%%                                          %%
%% Repeat \address commands as much as      %%
%% required.                                %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\address[id=aff1]{%                           % unique id
  \orgname{Plate-forme bio-informatique Genotoul / MIA-T, INRA}, % university, etc
  \street{Borde Rouge},                     %
  \postcode{31326}                                % post or zip code
  \city{Castanet-Tolosan},                              % city
  \cny{France}                                    % country
}
\address[id=aff2]{%
  \orgname{Plate-forme SIGENAE / GenPhySE, INRA}, % university, etc
  \street{Borde Rouge},                     %
  \postcode{31326}                                % post or zip code
  \city{Castanet-Tolosan},                              % city
  \cny{France}                                    % country
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Enter short notes here                   %%
%%                                          %%
%% Short notes will be after addresses      %%
%% on first page.                           %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{artnotes}
%\note{Sample of title note}     % note to the article
\note[id=n1]{Equal contributor} % note, connected to author
\end{artnotes}

\end{fmbox}% comment this for two column layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Abstract begins here                 %%
%%                                          %%
%% Please refer to the Instructions for     %%
%% authors on http://www.biomedcentral.com  %%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstractbox}

\begin{abstract} % abstract
\parttitle{Background} %if any
The amount of rich Web applications allowing scientists to store,
share and analyze data on-line is increasing. This enhances the need of embeddable
visualization tools. Scientists often produce lists of known identifiers
corresponding to different experimental conditions. The Venn diagram is one of
the most popular chart types used to present list comparison results.

\parttitle{Results} %if any
jvenn is a JavaScript library providing lists processing and Venn diagram
displaying functions. It is able to handle up to six input lists presenting
results as classical or Edwards-Venn diagrams. Using it, developers can easily
embed dynamic Venn diagrams in Web pages. jvenn is fully configurable and
allows to control and customize user interactions.

\parttitle{Conclusions} %if any
We introduce jvenn, an open source component for Web environments helping
scientists to analyze their data. The library package, which comes with full
documentation and an integration example, is freely available at
http://bioinfo.genotoul.fr/jvenn.


\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The keywords begin here                  %%
%%                                          %%
%% Put each keyword in separate \kwd{}.     %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{keyword}
\kwd{Venn}
\kwd{Edward-Venn}
\kwd{vizualisation}
\kwd{jquery}
\kwd{JavaScript}
\end{keyword}

% MSC classifications codes, if any
%\begin{keyword}[class=AMS]
%\kwd[Primary ]{}
%\kwd{}
%\kwd[; secondary ]{}
%\end{keyword}

\end{abstractbox}
%
%\end{fmbox}% uncomment this for twcolumn layout

\end{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% The Main Body begins here                %%
%%                                          %%
%% Please refer to the instructions for     %%
%% authors on:                              %%
%% http://www.biomedcentral.com/info/authors%%
%% and include the section headings         %%
%% accordingly for your article type.       %%
%%                                          %%
%% See the Results and Discussion section   %%
%% for details on how to create sub-sections%%
%%                                          %%
%% use \cite{...} to cite references        %%
%%  \cite{koon} and                         %%
%%  \cite{oreg,khar,zvai,xjon,schn,pond}    %%
%%  \nocite{smith,marg,hunn,advi,koha,mouse}%%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%% start of article main body
% <put your article body there>

%%%%%%%%%%%%%%%%
%% Background %%
%%

\section*{Background}

Biological projects are increasingly producing samples to assess differences
between conditions or individuals. Thus, it is important to provide researchers
with effective visualization tools to explore and extract relevant differences
between data sets. Data analysis often leads to compare lists of biological
identifiers (gene names, operational taxonomic unit, ...). 
List intersection results are commonly visualized using Venn diagrams
\cite{Venn1880} presenting shared and unshared identifier counts. They provide a
simple way to extract similarities and differences between the lists.

Many Venn diagram software packages are already available. They can be classified 
using their type : stand-alone, library, Web applications, JavaScript library and 
their diagram layout: classical or Edwards. Edwards-Venn \cite{Edwards2004} representation provides
a clearer view for diagrams having more than four lists (Fig. 2). VENNTURE \cite{Bronwen2012}
is a stand-alone application able to generate this layout for up to six lists. VennDiagram \cite{RVennDiagram}
is an R package including functions to draw classical diagrams from two to five lists. 

Venn diagrams are also often included in Web pages.  BioVenn \cite{Hulsen2008} and venny
\cite{venny} are Web applications with identifier input text areas. The
first one offers a three circles area-proportional diagram, the second one 
outputs a non-proportional four lists diagram. Canvasxpress
\cite{canvasxpress} and Google Chart API \cite{googleAPI} are
JavaScript libraries including Venn diagram features which can easily be
embedded in any Web page. They respectively produce diagrams with up to four and three lists.
Both generate graphical outputs given the intersection counts but cannot calculate them. 

We introduce jvenn, a JavaScript library helping scientists to present their
data, in the same spirit as already existing tools such as jbrowse
\cite{Westesson01032013}, Cytoscape-Web \cite{Lopes2010}, and jHeatmap
\cite{DeuPons2014}. jvenn handles up to six input lists, can display classical
or Edwards-Venn diagrams, can easily be embedded in a Web
page, allows three different data formats (lists, intersection counts and count
lists), exports PNG or CSV files and permits to redefine the callback function
in order to control users interactions. jvenn has already been cited in two
scientific publications \cite{Bianchia2013, Aravindraja2013} and is embedded
within nG6 \cite{Mariette2012}, RNAbrowse \cite{Mariette} and WallProtDB
\cite{SanClemente} Web applications.


\section*{Implementation}

jvenn is based on venny regarding the algorithm computing the lists intersections.
The algorithm has been wrapped in a jQuery plug-in \cite{jquery}, extended with 
new features presented hereunder and the ability to use up to six lists. 
It can be embedded in an HTML page referencing the JavaScript file. For researchers
who want to produce a Venn diagram from their identifier lists, jvenn is also
available as a Web application at http://bioinfo.genotoul.fr/jvenn/example.html.
The installation documentation is included in the software package which can be
downloaded from http://bioinfo.genotoul.fr/jvenn.

The library provides an option to define the input type : \textit{series}. It
accepts three different values : lists, intersection counts and count lists. 
They are all JSON objects. ``Lists'' contain for each input its label and an identifiers table. 
``Intersection counts'' contain a correspondence table 
between labels and letters [A..F] and a table linking the intersection names formed 
by the successions of letters and the counts. ``Count lists'' are organized as ``Lists'' 
in which identifiers are replaced by their unique occurrence and their count.   
Examples are presented in Table 1. In the case of list
or count lists \textit{series} jvenn will first execute a function to compute the
overlaps between lists and then display the chart. In the case of intersection
counts \textit{series}, the plug-in will only display the graphical result. The
display is based on a JavaScript canvas object allowing to export the chart as a
PNG file. The intersection table can also be downloaded as a CSV file. 
It contains a header line with all diagram area labels and in column all the 
identifiers of the elements contained in the area. These features can be disabled 
by setting the \textit{exporting} option to \textit{false} hiding the exporting
button.

The Web application developer can also define the diagram display setting the
\textit{displayType} option to \textit{edwards} or \textit{classic}. Setting the
\textit{shortNumber} option to \textit{false} will disable the default behaviour
of the plugin to substitute the intersection count by a question mark if this
one overflow its area. The callback function defining the click on an
intersection count can be overloaded by defining the \textit{fnClickCallback} parameter. 
This function give access to the \textit{this.listnames} and \textit{this.list} variables 
allowing the developer to control the user interactions. This feature can be disabled by 
setting the \textit{disableClick} option to \textit{true}. To customize the
diagram display, the developer can also settle the \textit{colors} option.


\section*{Results and Discussion}

Venn diagrams are commonly used to display list intersections because they are
simple to read and understand. This is true up to four lists but scientists are
interested in using it with more. This type of diagrams is able to present up
to six lists in its classical representation. Reaching this number, the
diagram can not a priori be proportional to the list counts and the intersection
areas are often too small to display the figures. 

To present in a user-friendly manner five or six list diagrams, jvenn implements
(Fig. 1) several functionalities. First, the display can be switched to Edwards-Venn
(Fig. 2) what gives a clearer graphical representation for six list diagrams. To
enhance the figure's readability on the classical six lists Venn graphic, it was decided not
to present all the values and to link some areas to their figures using lines.
This still did not permit to show all figures, therefore a switch button panel
(Fig. 1) was added. This panel enables to switch on and off the different lists
and display the corresponding intersection counts. For all the diagrams, when
the intersection count size exceeds the allowed space, the value is substituted
by a question mark. The real value pops-up on mouse over. Last, to show the
lists taking part in an intersection, jvenn highlights the corresponding areas on mouse over, 
fading the others out.

Scientists are usually interested in extracting identifier lists from some of
the intersections, therefore, jvenn implements an one-click function which
retrieves the names of the corresponding samples and the identifiers. Seeking
an identifier can also be done using the plugin. The intersection with the
matching identifier is highlighted so the user can visualize the lists sharing
it.

Having an overview of the list size and comparing multiple diagrams can be
difficult using a Venn diagram. Thus, jvenn provides two extra charts (Fig. 1) 
bellow the Venn. The first one represents the input lists size histogram. It
allows users to check the homogeneity of the lists size. The second one
displays the number of elements located in intersections of a certain size. This feature can
be used to compare the compactness of multiple Venn diagrams.

jvenn's performance depends on the client browser. Using the running version
on a standard Linux computer (1 cpu, 4GB of RAM), it displays a six lists diagram of 
10 000 identifiers in two seconds.

As examples, we produced two Venn diagrams representing six samples SRR068049,
SRR06805, SRR068051, SRR068052, SRR068053 and SRR068054 corresponding to sets of
Operational Taxonomic Units observed under different conditions. Fig. 1 shows
intersections between the six of them using the classical Venn diagram display.
In Fig. 2, jvenn highlights the intersection between three samples out of six
from an Edwards-Venn diagram.


\section*{Conclusions}

jvenn is an easy-to-use library which generates Venn and Edwards-Venn diagrams
from lists of identifiers or from computed intersection counts. Its
implementation as a library allows whoever has some JavaScript programming
skills to embed it in a Web page without any dependencies.

\section*{Availability and requirements}

jvenn is freely available under the GNU General Public License (GPL) and can be
downloaded with an example and the full documentation at
http://bioinfo.genotoul.fr/jvenn  website. A running version is accessible at
http://bioinfo.genotoul.fr/jvenn/example.html.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                          %%
%% Backmatter begins here                   %%
%%                                          %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{backmatter}

\section*{Competing interests}
The authors declare that they have no competing interests.

\section*{Author's contributions}
JM conceived and designed the project. JM, PB, FE and CD implemented the project.
CK evaluated software capabilities, and provided feedback on implementation. JM
and CK wrote the manuscript. All authors read and approved the final manuscript.

\section*{Acknowledgements}
We would like to acknowledge all our users for providing us useful feedback on
the system and for pointing out features worth developing.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                  The Bibliography                       %%
%%                                                         %%
%%  Bmc_mathpys.bst  will be used to                       %%
%%  create a .BBL file for submission.                     %%
%%  After submission of the .TEX file,                     %%
%%  you will be prompted to submit your .BBL file.         %%
%%                                                         %%
%%                                                         %%
%%  Note that the displayed Bibliography will not          %%
%%  necessarily be rendered by Latex exactly as specified  %%
%%  in the online Instructions for Authors.                %%
%%                                                         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% if your bibliography is in bibtex format, use those commands:
\bibliographystyle{bmc-mathphys} % Style BST file
\bibliography{bmc_jvenn}      % Bibliography file (usually '*.bib' )

% or include bibliography directly:
% \begin{thebibliography}
% \bibitem{b1}
% \end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Figures                       %%
%%                               %%
%% NB: this is for captions and  %%
%% Titles. All graphics must be  %%
%% submitted separately and NOT  %%
%% included in the Tex document  %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%
%% Do not use \listoffigures as most will included as separate files

\section*{Figures}
  \begin{figure}[h!]
  \caption{\csentence{A six lists classic Venn diagram.}
      This Venn diagram displays overlaps between six different biological
      samples. When the user clicks on a figure, it calls the developer defined
      function. The icon located on the top-right, allows users to download the
      diagram as a PNG file. On the bottom-right of the chart, a switch button
      panel allowing to activate or dis-activate lists to access a specific
      intersection count. The charts showing the lists size repartition and the
      number of common and specific elements are located underneath the
      diagram.}
      \end{figure}

\begin{figure}[h!]
  \caption{\csentence{A six lists Edwards-Venn diagram.}
      On mouse over a figure, the shape corresponding to the list involved in
      the intersection are highlighted and the other ones faded out. In
      this example, the user points the intersection between samples SRR068049,
      SRR068051 and SRR068052 which contains eight different items.}
      \end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                               %%
%% Tables                        %%
%%                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Use of \listoftables is discouraged.
%%
\section*{Tables}
\begin{table}[h!]
\caption{Available formats and example for the \textit{series} option.}
      \begin{tabular}{cccc}
        \hline
        format & example\\ \hline
        lists & 
\begin{lstlisting}
series: [{
	name: 'sample1',
	data: ["Otu1", "Otu2", "Otu3", "Otu4", "Otu5", "Otu6", "Otu7"]
}, {
	name: 'sample2',
	data: ["Otu1", "Otu2", "Otu5", "Otu7", "Otu8", "Otu9"]
}]
\end{lstlisting}\\ \hline
        intersection counts & 
\begin{lstlisting}
series: [{
	name: {A: 'sample 1', B: 'sample 2', C: 'sample 3'},
	data: {A: 340, B: 562, C: 620, AB: 639, AC: 456, BC: 915, ABC: 552}
}]
\end{lstlisting}\\ \hline
        count lists  &
\begin{lstlisting}
series: [{
	name: 'sample1',
	data: ["Otu1", "Otu2", "Otu3", "Otu4", "Otu5", "Otu6", "Otu7"],
	values: [5, 15, 250, 20, 23, 58, 89]
}, {
	name: 'sample2',
	data: ["Otu1", "Otu2", "Otu5", "Otu7", "Otu8", "Otu9"],
	values: [90, 300, 10, 2, 45, 9]
}]
\end{lstlisting}\\ \hline
      \end{tabular}
\end{table}

\end{backmatter}
\end{document}